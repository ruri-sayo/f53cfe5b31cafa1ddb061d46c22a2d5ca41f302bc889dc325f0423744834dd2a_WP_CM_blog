# 城上コードメモ v2.2 改良計画

作成日: 2025-12-27

本ドキュメントは `改良点.md` に記載された v2.2 向け改善・改良要望を分析し、各項目の実装可否と計画を示すものです。

---

## 実装可否サマリー

| # | 項目 | 可否 | 理由・備考 |
|---|------|:----:|-----------|
| 1 | 記事の左寄りに対する対策 | ✅ | CSS調整で対応可能 |
| 2 | PC推奨アイコン表示 | ✅ | `games.yml`への属性追加とレイアウト修正 |
| 3 | ヘッダー/フッターの色付け | ✅ | `default.html`のCSS変更 |
| 4 | カード全体クリック対応 | ✅ | `<a>`タグの範囲拡大 |
| 5 | イベントモード | ✅ | JavaScript + CSS で実装可能 |
| 6 | ヒーローエリア（土台） | ✅ | `home.html`への追加 |
| 7 | ヒーローエリア編集容易化 | ✅ | `_data/hero.yml`による管理 |
| 8 | novelコンテンツ投入 | ⚠️ | ユーザー作業が必要（コンテンツ作成） |
| 9 | novelモード実装 | ✅ | JavaScript + localStorage |
| 10 | モバイルナビゲーション | ✅ | ハンバーガーメニュー追加 |
| 11 | 連絡ページ設立 | ✅ | 新規ページ作成 |
| 12 | code_review.md指摘事項の修正 | ✅～⚠️ | 項目により異なる |

---

## 1. 記事などが左に寄っている原因に対する対策

### ✅ 実装可能

**現状分析:**  
`default.html` の main 要素に `max-w-none` が設定されており、コンテンツ幅の制限がなく左寄せに見える。

**実装計画:**

1. `_layouts/default.html` の main 要素修正
   ```html
   <main class="max-w-4xl mx-auto">
       {{ content }}
   </main>
   ```
2. 必要に応じて `custom.css` でテキストのアライメントを調整

**工数見積:** 0.5時間

---

## 2. ゲームのスマホ対応/PC推奨アイコン表示

### ✅ 実装可能

**実装計画:**

1. `_data/games.yml` に `platform` 属性を追加
   ```yaml
   - id: Character_Reversi
     title: "キャラクターリバーシ"
     platform: "pc"  # "pc" / "mobile" / "all"
   ```

2. アイコン画像の用意
   - `/assets/icon/platform_pc.svg`
   - `/assets/icon/platform_mobile.svg`
   - `/assets/icon/platform_all.svg`

3. `_layouts/home.html` および `game/index.html` のゲームカード表示部分を修正
   ```liquid
   {% if game.platform == "pc" %}
     <img src="/assets/icon/platform_pc.svg" alt="PC推奨" class="w-5 h-5">
   {% endif %}
   ```

**工数見積:** 1時間

---

## 3. ヘッダーとフッターの色付け

### ✅ 実装可能

**実装計画:**

1. `_layouts/default.html` のヘッダー/フッター要素に背景色を追加
   ```html
   <header class="flex justify-between items-center border-b pb-4 mb-8" 
           style="background-color: #7278a8;">
   ```

2. テキスト色を白に変更してコントラストを確保
   ```html
   <h1 class="text-3xl font-bold text-white">
   ```

3. `custom.css` に色の変数化を検討（後のイベントモード対応のため）
   ```css
   :root {
     --header-bg: #7278a8;
     --footer-bg: #7278a8;
   }
   ```

**工数見積:** 0.5時間

---

## 4. カード全体をクリック/タップで遷移

### ✅ 実装可能

**実装計画:**

1. 現在の構造を変更し、カード全体を `<a>` タグで囲む

   **Before:**
   ```html
   <div class="bg-white p-4 rounded-lg shadow-sm">
     <h3><a href="...">タイトル</a></h3>
   </div>
   ```

   **After:**
   ```html
   <a href="..." class="block bg-white p-4 rounded-lg shadow-sm hover:shadow-md">
     <h3>タイトル</h3>
   </a>
   ```

2. 影響範囲:
   - `_layouts/home.html` (4箇所)
   - `posts/index.html`
   - `tools/index.html`
   - `game/index.html`
   - `novel/index.html`

**工数見積:** 1.5時間

---

## 5. イベントモードの実装

### ✅ 実装可能

**実装計画:**

#### Phase 1: イベントデータ定義
1. `_data/events.yml` を作成
   ```yaml
   - id: newyear
     name: 正月
     start: "01-01"
     end: "01-04"
     bg_color: "#FFE4E1"
     decoration: "newyear"
   
   - id: christmas
     name: クリスマス
     start: "12-24"
     end: "12-25"
     bg_color: "#228B22"
     decoration: "christmas"
   ```

#### Phase 2: JavaScript 自動切り替え
2. `assets/js/event-mode.js` を作成
   - 現在の日付からイベントを判定
   - CSS クラスを body に付与
   - デバッグコマンド `window.setEvent('christmas')` を実装

#### Phase 3: CSS スタイル
3. `assets/css/events.css` に各イベントのスタイルを定義
   ```css
   body.event-christmas header {
     background: linear-gradient(#c41e3a, #228b22);
   }
   body.event-christmas::before {
     content: "❄️";
     /* 雪の結晶デコレーション */
   }
   ```

#### Phase 4: デコレーション素材
4. SVG またはアニメーションで各イベントの飾りを作成

**工数見積:** 4～6時間

---

## 6. ヒーローエリアの設置（土台のみ）

### ✅ 実装可能

**実装計画:**

1. `_layouts/home.html` の先頭にヒーローセクションを追加
   ```html
   {% if site.data.hero and site.data.hero.enabled %}
   <section class="hero-area bg-gradient-to-r from-blue-500 to-purple-600 
                    text-white p-8 rounded-lg mb-8">
     <h2 class="text-3xl font-bold">{{ site.data.hero.title }}</h2>
     <p class="mt-4">{{ site.data.hero.message }}</p>
   </section>
   {% endif %}
   ```

2. `_data/hero.yml` を作成（デフォルトは無効）
   ```yaml
   enabled: false
   title: ""
   message: ""
   ```

**工数見積:** 0.5時間

---

## 7. ヒーローエリアの編集容易化

### ✅ 実装可能

**実装計画:**

1. 上記 `_data/hero.yml` による管理で対応
2. 複数メッセージのローテーション対応（オプション）
   ```yaml
   enabled: true
   messages:
     - title: "新年あけましておめでとうございます"
       message: "2025年もよろしくお願いします"
       expires: "2025-01-04"
   ```

**工数見積:** 1時間（オプション含む）

---

## 8. novelコンテンツの投入

### ⚠️ 一部実装可能（ユーザー作業必要）

**説明:**  
コンテンツ（小説本文）はユーザーが作成する必要があります。

**実装可能な範囲:**
- `_novel/` 配下のディレクトリ・ファイルテンプレート作成
- 新規シリーズ追加ガイドの作成

**実装不可能な範囲:**
- 小説本文の執筆（ユーザー作業）

**工数見積:** テンプレート作成: 0.5時間

---

## 9. novelモードの実装

### ✅ 実装可能

**実装計画:**

#### 機能一覧:
- 白黒切り替え
- 文字サイズ切り替え（大/中/小）
- 文字色・背景色のカスタム設定

#### 実装詳細:

1. `_layouts/novel_episode.html` に設定UIを追加
   ```html
   <div id="novel-settings" class="fixed bottom-4 right-4">
     <button onclick="toggleSettings()">⚙️</button>
   </div>
   ```

2. `assets/js/novel-mode.js` を作成
   ```javascript
   const NovelMode = {
     save() {
       localStorage.setItem('novelSettings', JSON.stringify(this.settings));
     },
     load() {
       return JSON.parse(localStorage.getItem('novelSettings'));
     },
     setFontSize(size) { /* 大/中/小 */ },
     setTheme(theme) { /* 白/黒 */ },
     setCustomColors(fg, bg) { /* カスタム色 */ }
   };
   ```

3. `assets/css/novel-mode.css` を作成
   ```css
   .novel-dark { background: #1a1a1a; color: #e0e0e0; }
   .novel-light { background: #fff; color: #333; }
   .font-large { font-size: 1.25rem; }
   .font-medium { font-size: 1rem; }
   .font-small { font-size: 0.875rem; }
   ```

**工数見積:** 2時間

---

## 10. モバイルナビゲーションの実装

### ✅ 実装可能（優先度高）

**実装計画:**

1. `_layouts/default.html` にハンバーガーメニューボタンを追加
   ```html
   <button id="menu-toggle" class="md:hidden">
     <svg><!-- ハンバーガーアイコン --></svg>
   </button>
   ```

2. モバイル用のスライドメニュー/オーバーレイを追加
   ```html
   <nav id="mobile-menu" class="fixed inset-0 bg-white transform 
                                 translate-x-full transition-transform md:hidden">
     <a href="/">ホーム</a>
     ...
   </nav>
   ```

3. `assets/js/mobile-nav.js` でトグル処理

**工数見積:** 1.5時間

---

## 11. 連絡ページの設立

### ✅ 実装可能

**実装計画:**

1. `contact.md` または `contact.html` を作成

2. ページ内容:
   ```markdown
   ---
   layout: page
   title: Contact
   permalink: /contact/
   ---
   
   ## お問い合わせ
   
   - **GitHub**: [ruri-sayo](https://github.com/ruri-sayo)
   - **Email**: <span id="email-display"></span>
   ```

3. メールアドレスの難読化（JavaScript）
   ```javascript
   document.getElementById('email-display').innerHTML = 
     ['sayohindakedo', 'gmail.com'].join('@');
   ```

**工数見積:** 1時間

---

## 12. code_review.md 指摘事項の修正

### 各項目の詳細

| 項目 | 可否 | 対応内容 |
|------|:----:|----------|
| モバイルナビゲーション | ✅ | → 項目10で対応 |
| Tailwind CSS CDN問題 | ⚠️ | ビルド環境構築が必要。当面CDN継続も可 |
| 意味のないファイル名 | ✅ | `aaaaa.html` → `speech_timer.html`等にリネーム |
| aboutページ | ⚠️ | ユーザー情報記載が必要。テンプレート作成可 |
| 404ページ日本語化 | ✅ | 即座に対応可能 |
| meta description修正 | ✅ | `_config.yml`と`head.html`を修正 |
| tools.yml id付与 | ✅ | idなしツールにid追加 |
| 空のhref属性 | ✅ | `default.html`を修正 |
| 一部ツールのicon未設定 | ⏸️ | 後日対応として保留 |
| ファビコン圧縮 | ⚠️ | ICO形式の制約あり。PNG変換推奨 |

### 詳細対応計画

#### 12-a. 意味のないファイル名の修正

**リネーム対象:**
- `tools/aaaaa.html` → `tools/speech_timer.html`
- `tools/coount_moji.html` → `tools/character_counter.html`（typo修正含む）

**作業:**
1. ファイルリネーム
2. `_data/tools.yml` の `url` 更新
3. リダイレクト設定（既存リンク対策）

**工数見積:** 0.5時間

---

#### 12-b. 404ページ日本語化

**実装計画:**

```html
---
permalink: /404.html
layout: default
---

<div class="text-center py-16">
  <h1 class="text-6xl font-bold text-gray-300">404</h1>
  <p class="text-xl text-gray-600 mt-4">お探しのページが見つかりませんでした</p>
  <p class="text-gray-500 mt-2">URLが間違っているか、ページが移動した可能性があります。</p>
  <a href="/" class="inline-block mt-8 px-6 py-3 bg-blue-600 text-white rounded-lg 
                      hover:bg-blue-700 transition-colors">
    ホームに戻る
  </a>
</div>
```

**工数見積:** 0.5時間

---

#### 12-c. meta descriptionの修正

**実装計画:**

1. `_config.yml` を修正
   ```yaml
   description: >-
     城上コードメモは、便利なWebツール、ゲーム、小説などを公開する個人ブログサイトです。
   ```

2. `_includes/head.html` に追加
   ```html
   <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
   ```

**工数見積:** 0.5時間

---

#### 12-d. tools.yml id付与

**idなしツール:**
- TeXレンダラー → `id: tex_renderer`
- 資産シミュレーター → `id: asset_simulator`
- 迷路ゲーム（簡単）→ `id: maze_easy`
- 迷路ゲーム（難しい）→ `id: maze_hard`
- スクリーンセイバー → `id: screen_saver`
- ミリオンライブ相関分析 → `id: million_graph_corr`
- ミリオンライブ3D分布 → `id: million_graph_3d`

**工数見積:** 0.25時間

---

#### 12-e. 空のhref属性修正

**対象:**  
`_layouts/default.html` L40

```html
<!-- Before -->
<a href="" >Sayo Social Connect</a>

<!-- After -->
<a href="https://ruri-sayo.github.io/SSC_site/">Sayo Social Connect</a>
```

**工数見積:** 5分

---

#### 12-f. ファビコン圧縮

### ⚠️ 部分的に実装可能

**現状:**  
`favicon.ico` が約450KBと非常に大きい。

**課題:**  
ICO形式は複数サイズの画像を含むため、単純な圧縮が難しい。

**推奨対応:**
1. 現在のICOファイルから必要なサイズのみ抽出（16x16, 32x32, 48x48）
2. PNG形式のファビコンに変換し、link タグで指定
   ```html
   <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
   <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
   ```
3. オンラインツール（例: [RealFaviconGenerator](https://realfavicongenerator.net/)）の利用

**工数見積:** 0.5時間

---

## 工数まとめ

| 項目 | 工数（時間） | 優先度 |
|------|-------------|--------|
| 1. 左寄り修正 | 0.5 | 中 |
| 2. PC推奨アイコン | 1 | 中 |
| 3. ヘッダー/フッター色 | 0.5 | 低 |
| 4. カード全体クリック | 1.5 | 高 |
| 5. イベントモード | 4-6 | 低 |
| 6. ヒーローエリア土台 | 0.5 | 低 |
| 7. ヒーロー編集容易化 | 1 | 低 |
| 8. novelコンテンツ | 0.5 | ユーザー依存 |
| 9. novelモード | 2 | 中 |
| 10. モバイルナビ | 1.5 | **最優先** |
| 11. 連絡ページ | 1 | 中 |
| 12. code_review修正 | 2 | 高 |

**合計:** 約16-18時間

---

## 推奨実装順序

### Phase 1: 緊急対応（優先度高）
1. **モバイルナビゲーション** - ユーザビリティに直結
2. **404ページ日本語化** - 簡単かつ効果大
3. **空のhref修正** - 即座に対応可能

### Phase 2: UX改善
4. **カード全体クリック対応** - 操作性向上
5. **meta description修正** - SEO対策
6. **tools.yml id付与** - 管理性向上

### Phase 3: デザイン改善
7. **ヘッダー/フッターの色付け**
8. **左寄り修正**
9. **PC推奨アイコン表示**

### Phase 4: 機能追加
10. **連絡ページ設立**
11. **novelモード実装**
12. **ヒーローエリア**

### Phase 5: 特殊機能
13. **イベントモード** - 工数大のため最後に

---

*計画作成: Antigravity AI*
