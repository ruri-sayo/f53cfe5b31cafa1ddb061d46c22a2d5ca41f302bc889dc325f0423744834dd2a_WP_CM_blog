---
import { SITE_TITLE, SITE_DESCRIPTION, getFullPath } from '../consts';
import eventsData from '../data/events.json';
import '../styles/global.css';

interface Props {
	title?: string;
	description?: string;
}

const { title, description = SITE_DESCRIPTION } = Astro.props;
const siteTitle = SITE_TITLE;
const pageTitle = title ? `${title} | ${siteTitle}` : siteTitle;

// イベントデータをクライアントサイドに渡すための整形
const eventsJson = JSON.stringify(eventsData.events);
---

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- 限定公開運用のため既定で noindex -->
<meta name="robots" content="noindex,nofollow" />

<title>{pageTitle}</title>

<!-- Meta Description -->
<meta name="description" content={description} />

<!-- ファビコン（最適化済みPNG） -->
<link rel="icon" type="image/png" sizes="32x32" href={getFullPath("/favicon-32x32.png")} />
<link rel="icon" type="image/png" sizes="16x16" href={getFullPath("/favicon-16x16.png")} />
<link rel="apple-touch-icon" sizes="180x180" href={getFullPath("/apple-touch-icon.png")} />

<!-- カスタム CSS -->
<link rel="stylesheet" href={getFullPath("/assets/css/custom.css")} />

<!-- イベントモード用CSS -->
<link rel="stylesheet" href={getFullPath("/assets/css/events.css")} />

<!-- イベントデータ埋め込み -->
<script is:inline define:vars={{ eventsJson }}>
  // JSONパースしてグローバル変数にセット
  window.SHIROGAMI_EVENTS = JSON.parse(eventsJson);
</script>

<!-- イベントモード用JavaScript -->
<script src={getFullPath("/assets/js/event-mode.js")} defer is:inline></script>

<!-- MathJax設定 -->
<script is:inline>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
  };
</script>

<!-- MathJaxロード -->
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" is:inline></script>

<style>
  html {
    scroll-behavior: smooth;
  }
</style>
