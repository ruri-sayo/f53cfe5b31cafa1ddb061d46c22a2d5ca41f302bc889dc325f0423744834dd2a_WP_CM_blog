---
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';

type Props = CollectionEntry<'posts'>['data'];

const { title, description, date, categories } = Astro.props;

// カテゴリが文字列の場合と配列の場合の両方に対応
const categoryList = Array.isArray(categories) 
  ? categories 
  : typeof categories === 'string' 
    ? [categories] 
    : [];

const formattedDate = date ? new Date(date).toLocaleDateString('ja-JP', {
	year: 'numeric',
	month: '2-digit',
	day: '2-digit',
}).replace(/\//g, '-') : '';

---

<BaseLayout title={title} description={description}>
	<article class="prose prose-neutral max-w-none">
		<header class="mb-6">
			<h1 class="text-3xl font-bold">{title}</h1>
			<p class="text-gray-500 text-sm">{formattedDate}
				{categoryList.length > 0 && (
					<>
						· <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-semibold">{categoryList.join(', ')}</span>
					</>
				)}
			</p>
			{description && (
				<p class="text-gray-600 mt-2">{description}</p>
			)}
		</header>
		<slot />
	</article>
</BaseLayout>
